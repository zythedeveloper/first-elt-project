

============================== 2025-01-16 13:27:27.500217 | 7f99563a-27bf-43d2-b6a9-968c0e75e0a1 ==============================
[0m13:27:27.500217 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:27:27.502120 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:27:27.502827 [debug] [MainThread]: Tracking: tracking
[0m13:27:27.513195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff254b90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff254b97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff254b9390>]}
[0m13:27:27.522459 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:27:27.526124 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:27:27.526801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f99563a-27bf-43d2-b6a9-968c0e75e0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff254b9ed0>]}
[0m13:27:28.196377 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m13:27:28.207496 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m13:27:28.210514 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m13:27:28.214425 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:27:28.333962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f99563a-27bf-43d2-b6a9-968c0e75e0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23b67430>]}
[0m13:27:28.348973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f99563a-27bf-43d2-b6a9-968c0e75e0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23be7b80>]}
[0m13:27:28.349758 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:27:28.350510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f99563a-27bf-43d2-b6a9-968c0e75e0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23be5960>]}
[0m13:27:28.352259 [info ] [MainThread]: 
[0m13:27:28.354255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:28.355726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:27:28.365749 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:27:28.366494 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:27:28.367281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:28.386957 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: FATAL:  password authentication failed for user "postgres"

[0m13:27:28.395648 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:27:28.396394 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:27:28.397063 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:27:28.397604 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:27:28.398139 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m13:27:28.399431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:28.399960 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m13:27:28.400527 [info ] [MainThread]: 
[0m13:27:28.401336 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m13:27:28.402037 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: FATAL:  password authentication failed for user "postgres"
  
[0m13:27:28.402769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23bdab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23c23970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff23c23a60>]}
[0m13:27:28.403383 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:29:39.994890 | 5fa873a4-e5e5-461e-bada-186c3cc9c929 ==============================
[0m13:29:39.994890 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:29:39.996591 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:29:39.997162 [debug] [MainThread]: Tracking: tracking
[0m13:29:40.002312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb532810f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb532817b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53281390>]}
[0m13:29:40.020084 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:29:40.038076 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:29:40.038934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53283f10>]}
[0m13:29:40.690842 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m13:29:40.702018 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m13:29:40.705253 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m13:29:40.709343 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:29:40.829140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb51abb910>]}
[0m13:29:40.842604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53283d60>]}
[0m13:29:40.843474 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:29:40.844246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb51a66110>]}
[0m13:29:40.846072 [info ] [MainThread]: 
[0m13:29:40.848132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:40.849599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:29:40.859534 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:29:40.860172 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:29:40.860829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:40.879924 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:29:40.881615 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:29:40.883664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:29:40.889806 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:29:40.890332 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:29:40.890815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:40.901152 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:29:40.901787 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:29:40.902403 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:29:40.905503 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:29:40.907197 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:29:40.908842 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:29:40.915235 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:40.915826 [debug] [MainThread]: On master: BEGIN
[0m13:29:40.916395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:40.926623 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:40.927236 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:40.927837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:40.932319 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:29:40.933874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb519ce9e0>]}
[0m13:29:40.934642 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:40.936193 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:40.936805 [debug] [MainThread]: On master: BEGIN
[0m13:29:40.939328 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:40.940029 [debug] [MainThread]: On master: COMMIT
[0m13:29:40.940671 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:40.941236 [debug] [MainThread]: On master: COMMIT
[0m13:29:40.942699 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:29:40.943273 [debug] [MainThread]: On master: Close
[0m13:29:40.944171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:40.944863 [info ] [MainThread]: 
[0m13:29:40.957874 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:29:40.958673 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:29:40.959794 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:29:40.960441 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:29:40.962466 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:29:40.974821 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:29:40.961012 => 2025-01-16 13:29:40.974736
[0m13:29:40.975495 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:29:41.012325 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:29:41.024689 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:29:41.025241 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:29:41.025759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:41.037436 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:41.038059 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:29:41.038634 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM {( source('destination_db', 'actors') )}
  );
  
[0m13:29:41.040712 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 8:     SELECT * FROM {( source('destination_db', 'actors') )}
                          ^

[0m13:29:41.041248 [debug] [Thread-1 (]: On model.transforms.actors: ROLLBACK
[0m13:29:41.042681 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:29:40.976029 => 2025-01-16 13:29:41.042610
[0m13:29:41.043401 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:29:41.048774 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  syntax error at or near "{"
  LINE 8:     SELECT * FROM {( source('destination_db', 'actors') )}
                            ^
  compiled Code at target/run/transforms/models/example/actors.sql
[0m13:29:41.049635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb500bc7c0>]}
[0m13:29:41.050511 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.09s]
[0m13:29:41.052532 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:29:41.053226 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:29:41.053913 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:29:41.054926 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:29:41.055473 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:29:41.058637 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:29:41.064015 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:29:41.055955 => 2025-01-16 13:29:41.063949
[0m13:29:41.064590 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:29:41.068744 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:29:41.074805 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:29:41.075382 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:29:41.075905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:41.087386 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:41.088092 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:29:41.088687 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM {( source('destination_db', 'film_actors') )}
  );
  
[0m13:29:41.090310 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 8:     SELECT * FROM {( source('destination_db', 'film_actors')...
                          ^

[0m13:29:41.090882 [debug] [Thread-1 (]: On model.transforms.film_actors: ROLLBACK
[0m13:29:41.092251 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:29:41.065047 => 2025-01-16 13:29:41.092190
[0m13:29:41.092779 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:29:41.094108 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  syntax error at or near "{"
  LINE 8:     SELECT * FROM {( source('destination_db', 'film_actors')...
                            ^
  compiled Code at target/run/transforms/models/example/film_actors.sql
[0m13:29:41.094823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb500f88b0>]}
[0m13:29:41.095598 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.04s]
[0m13:29:41.096562 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:29:41.097208 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:29:41.097849 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:29:41.098781 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:29:41.099405 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:29:41.101326 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:29:41.106652 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:29:41.099870 => 2025-01-16 13:29:41.106596
[0m13:29:41.107189 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:29:41.112149 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:29:41.117720 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:29:41.118248 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:29:41.118814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:41.129790 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:41.130519 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:29:41.131120 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM {( source('destination_db', 'films') )}
  );
  
[0m13:29:41.132718 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 8:     SELECT * FROM {( source('destination_db', 'films') )}
                          ^

[0m13:29:41.133300 [debug] [Thread-1 (]: On model.transforms.films: ROLLBACK
[0m13:29:41.134699 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:29:41.107693 => 2025-01-16 13:29:41.134639
[0m13:29:41.135216 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:29:41.136337 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  syntax error at or near "{"
  LINE 8:     SELECT * FROM {( source('destination_db', 'films') )}
                            ^
  compiled Code at target/run/transforms/models/example/films.sql
[0m13:29:41.137082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa873a4-e5e5-461e-bada-186c3cc9c929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb519635e0>]}
[0m13:29:41.137906 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.04s]
[0m13:29:41.138683 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:29:41.140046 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:29:41.140640 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m13:29:41.141366 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:29:41.142963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:41.143507 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:41.144017 [debug] [MainThread]: On master: BEGIN
[0m13:29:41.144553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:41.155073 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:41.155765 [debug] [MainThread]: On master: COMMIT
[0m13:29:41.156297 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:41.156870 [debug] [MainThread]: On master: COMMIT
[0m13:29:41.158166 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:29:41.158746 [debug] [MainThread]: On master: Close
[0m13:29:41.159579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:41.160008 [debug] [MainThread]: Connection 'model.transforms.films' was properly closed.
[0m13:29:41.160488 [info ] [MainThread]: 
[0m13:29:41.161129 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:29:41.162021 [debug] [MainThread]: Command end result
[0m13:29:41.172520 [info ] [MainThread]: 
[0m13:29:41.173285 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:29:41.173976 [info ] [MainThread]: 
[0m13:29:41.174625 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m13:29:41.175283 [error] [MainThread]:   syntax error at or near "{"
[0m13:29:41.175891 [error] [MainThread]:   LINE 8:     SELECT * FROM {( source('destination_db', 'actors') )}
[0m13:29:41.176556 [error] [MainThread]:                             ^
[0m13:29:41.177152 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/actors.sql
[0m13:29:41.177747 [info ] [MainThread]: 
[0m13:29:41.178331 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m13:29:41.178941 [error] [MainThread]:   syntax error at or near "{"
[0m13:29:41.179627 [error] [MainThread]:   LINE 8:     SELECT * FROM {( source('destination_db', 'film_actors')...
[0m13:29:41.180171 [error] [MainThread]:                             ^
[0m13:29:41.180756 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_actors.sql
[0m13:29:41.181291 [info ] [MainThread]: 
[0m13:29:41.181813 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m13:29:41.182336 [error] [MainThread]:   syntax error at or near "{"
[0m13:29:41.182857 [error] [MainThread]:   LINE 8:     SELECT * FROM {( source('destination_db', 'films') )}
[0m13:29:41.183391 [error] [MainThread]:                             ^
[0m13:29:41.183913 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/films.sql
[0m13:29:41.184439 [info ] [MainThread]: 
[0m13:29:41.184979 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:29:41.185624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb51ab9240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb500f8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb500f8850>]}
[0m13:29:41.186141 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:31:26.407658 | 1e93883c-e2f1-44ae-8870-152d5ea18b0b ==============================
[0m13:31:26.407658 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:31:26.409404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:31:26.409977 [debug] [MainThread]: Tracking: tracking
[0m13:31:26.415131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8569010c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc856901780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc856901360>]}
[0m13:31:26.429227 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:31:26.550059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:31:26.550967 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_actors.sql
[0m13:31:26.551544 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/actors.sql
[0m13:31:26.552209 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/films.sql
[0m13:31:26.575001 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m13:31:26.588659 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m13:31:26.591778 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m13:31:26.653823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85409ffd0>]}
[0m13:31:26.665737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc856904a00>]}
[0m13:31:26.666395 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:31:26.667032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc856905d50>]}
[0m13:31:26.668980 [info ] [MainThread]: 
[0m13:31:26.671125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:26.672630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:31:26.682659 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:31:26.683284 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:31:26.683912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:26.702662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:31:26.704203 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:31:26.706176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:31:26.712305 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:31:26.713075 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:31:26.713744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:26.725055 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:31:26.725810 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:31:26.726759 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:31:26.730870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:31:26.732700 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:31:26.734204 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:31:26.740746 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:26.741370 [debug] [MainThread]: On master: BEGIN
[0m13:31:26.741900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:26.753791 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:31:26.754454 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:26.754940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:26.759295 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:31:26.760824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85503e230>]}
[0m13:31:26.761410 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:26.762973 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:26.763554 [debug] [MainThread]: On master: BEGIN
[0m13:31:26.765886 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:31:26.766366 [debug] [MainThread]: On master: COMMIT
[0m13:31:26.766835 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:26.767295 [debug] [MainThread]: On master: COMMIT
[0m13:31:26.768592 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:31:26.769065 [debug] [MainThread]: On master: Close
[0m13:31:26.769876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:26.770508 [info ] [MainThread]: 
[0m13:31:26.783454 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:31:26.784323 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:31:26.785395 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:31:26.786019 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:31:26.789187 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:31:26.795350 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:31:26.786578 => 2025-01-16 13:31:26.795274
[0m13:31:26.796012 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:31:26.833172 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:31:26.838980 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.839499 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:31:26.840018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:26.851229 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:31:26.851841 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.852311 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:31:26.854398 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:31:26.860682 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.861166 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:31:26.862655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:26.865366 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.865993 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:31:26.867475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:26.888506 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:31:26.889251 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.889720 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:31:26.892917 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:31:26.898270 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:31:26.898754 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:31:26.902596 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:31:26.904044 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:31:26.796558 => 2025-01-16 13:31:26.903997
[0m13:31:26.904528 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:31:26.905429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8541507f0>]}
[0m13:31:26.906096 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.12s]
[0m13:31:26.908353 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:31:26.909062 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:31:26.909699 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:31:26.910660 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:31:26.911195 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:31:26.914022 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:31:26.918273 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:31:26.911653 => 2025-01-16 13:31:26.918223
[0m13:31:26.918764 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:31:26.924029 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:31:26.928416 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.928849 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:31:26.929299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:26.940337 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:31:26.940939 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.941445 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:31:26.943907 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:31:26.946790 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.947256 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:31:26.948654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:26.951571 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.952324 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:31:26.954028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:26.955892 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:31:26.956361 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.956849 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:31:26.959548 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:31:26.961806 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:31:26.962387 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:31:26.965860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:31:26.967221 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:31:26.919150 => 2025-01-16 13:31:26.967174
[0m13:31:26.967738 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:31:26.968690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85418eec0>]}
[0m13:31:26.969309 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m13:31:26.970077 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:31:26.970823 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:31:26.971600 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:31:26.972638 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:31:26.973222 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:31:26.976375 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:31:26.982255 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:31:26.973795 => 2025-01-16 13:31:26.982187
[0m13:31:26.982846 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:31:26.987014 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:31:26.993549 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:26.994167 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:31:26.994676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:27.005677 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:31:27.006325 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:27.006819 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:31:27.008929 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:31:27.011793 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:27.012338 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:31:27.013878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:27.016499 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:27.017052 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:31:27.018704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:31:27.020960 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:31:27.021475 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:27.021958 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:31:27.024776 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:31:27.027105 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:31:27.027681 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:31:27.031685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:31:27.033491 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:31:26.983312 => 2025-01-16 13:31:27.033429
[0m13:31:27.034052 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:31:27.035038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85418eec0>]}
[0m13:31:27.035823 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m13:31:27.036667 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:31:27.037979 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:31:27.038604 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:31:27.039526 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m13:31:27.040095 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m13:31:27.045027 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m13:31:27.050949 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 13:31:27.040598 => 2025-01-16 13:31:27.050886
[0m13:31:27.051504 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m13:31:27.055490 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m13:31:27.061642 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:31:27.062182 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m13:31:27.062704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:27.073611 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:31:27.074334 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:31:27.074879 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id, 
        title, 
        release_date, 
        price, 
        rating,
        user_rating
        CASE
            WHEN user_rating >= 4.5 THEN 'Execellent'
            WHEN user_rating >= 4.5 THEN 'Good'
            WHEN user_rating >= 4.5 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT 
        f.film_id, 
        f.title, 
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa USING film_id
    LEFT JOIN "destination_db"."public"."actors" a USING film_id
    GROUP BY f.film_id, f.title
)

SELECT
    films_with_ratings.*,
    films_with_actors.actors
FROM films_with_ratings
LEFT JOIN films_with_actors USING film_id
  );
  
[0m13:31:27.076719 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WHEN"
LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
                     ^

[0m13:31:27.077250 [debug] [Thread-1 (]: On model.transforms.film_ratings: ROLLBACK
[0m13:31:27.078663 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 13:31:27.051952 => 2025-01-16 13:31:27.078603
[0m13:31:27.079174 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m13:31:27.084337 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "WHEN"
  LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
                       ^
  compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:31:27.085072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e93883c-e2f1-44ae-8870-152d5ea18b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83d54b6a0>]}
[0m13:31:27.085814 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.05s]
[0m13:31:27.086620 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:31:27.088514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:27.089021 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:27.089486 [debug] [MainThread]: On master: BEGIN
[0m13:31:27.089997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:27.100351 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:31:27.100938 [debug] [MainThread]: On master: COMMIT
[0m13:31:27.101459 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:27.101895 [debug] [MainThread]: On master: COMMIT
[0m13:31:27.103157 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:31:27.103688 [debug] [MainThread]: On master: Close
[0m13:31:27.104555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:27.105026 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m13:31:27.105508 [info ] [MainThread]: 
[0m13:31:27.106137 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:31:27.107054 [debug] [MainThread]: Command end result
[0m13:31:27.119218 [info ] [MainThread]: 
[0m13:31:27.120001 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:31:27.120695 [info ] [MainThread]: 
[0m13:31:27.121333 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:31:27.122005 [error] [MainThread]:   syntax error at or near "WHEN"
[0m13:31:27.122806 [error] [MainThread]:   LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
[0m13:31:27.123594 [error] [MainThread]:                        ^
[0m13:31:27.124477 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:31:27.125164 [info ] [MainThread]: 
[0m13:31:27.125747 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:31:27.126396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85503c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85503c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc85503e140>]}
[0m13:31:27.126963 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:36:07.397150 | 865b9744-c20a-4eba-ba24-6842d4af26d1 ==============================
[0m13:36:07.397150 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:36:07.399033 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:36:07.399650 [debug] [MainThread]: Tracking: tracking
[0m13:36:07.404909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc17950f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc17957b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc1795390>]}
[0m13:36:07.418305 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:36:07.569417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:07.570339 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_ratings.sql
[0m13:36:07.592603 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:36:07.658322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbff04d00>]}
[0m13:36:07.671894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbfe83730>]}
[0m13:36:07.672541 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:36:07.673252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc17a3850>]}
[0m13:36:07.675078 [info ] [MainThread]: 
[0m13:36:07.677382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:07.678761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:36:07.688790 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:36:07.689512 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:36:07.690166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:07.709397 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:36:07.711131 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:36:07.713401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:36:07.719006 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:36:07.719619 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:36:07.720270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:07.731154 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:36:07.731797 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:36:07.732415 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:36:07.735814 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:36:07.737800 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:36:07.739309 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:36:07.745777 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:07.746367 [debug] [MainThread]: On master: BEGIN
[0m13:36:07.746948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:07.758000 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:36:07.758872 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:07.759445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:36:07.764721 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:36:07.766083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbe5506d0>]}
[0m13:36:07.766807 [debug] [MainThread]: On master: ROLLBACK
[0m13:36:07.768343 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:07.768904 [debug] [MainThread]: On master: BEGIN
[0m13:36:07.771196 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:36:07.771724 [debug] [MainThread]: On master: COMMIT
[0m13:36:07.772280 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:07.772829 [debug] [MainThread]: On master: COMMIT
[0m13:36:07.774188 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:36:07.774747 [debug] [MainThread]: On master: Close
[0m13:36:07.775820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:07.776673 [info ] [MainThread]: 
[0m13:36:07.791173 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:36:07.791980 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:36:07.793110 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:36:07.793792 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:36:07.796445 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:36:07.801959 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:36:07.794325 => 2025-01-16 13:36:07.801904
[0m13:36:07.802620 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:36:07.837838 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:36:07.844081 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.844783 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:36:07.845260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:07.855414 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:36:07.856063 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.856652 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:36:07.858839 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:36:07.864917 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.865430 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:36:07.866803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:07.869646 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.870162 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:36:07.871447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:07.892936 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:36:07.893589 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.894085 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:36:07.897396 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:36:07.902885 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:36:07.903500 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:36:07.907565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:36:07.909110 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:36:07.803161 => 2025-01-16 13:36:07.909059
[0m13:36:07.909744 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:36:07.910888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbe5f9600>]}
[0m13:36:07.911754 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.12s]
[0m13:36:07.914072 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:36:07.914838 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:36:07.915578 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:36:07.916554 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:36:07.917137 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:36:07.919720 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:36:07.925316 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:36:07.917606 => 2025-01-16 13:36:07.925256
[0m13:36:07.925899 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:36:07.930679 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:36:07.937279 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.937921 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:36:07.938739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:07.949902 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:36:07.950628 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.951220 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:36:07.953605 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:36:07.956427 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.956931 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:36:07.958352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:07.961392 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.961973 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:36:07.963684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:07.966189 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:36:07.966819 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.967316 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:36:07.970092 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:36:07.972264 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:36:07.972849 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:36:07.976342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:36:07.978223 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:36:07.926412 => 2025-01-16 13:36:07.978088
[0m13:36:07.978878 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:36:07.979881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbe5c9f30>]}
[0m13:36:07.980603 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m13:36:07.981345 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:36:07.982067 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:36:07.982734 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:36:07.983666 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:36:07.984257 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:36:07.987321 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:36:07.993599 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:36:07.984794 => 2025-01-16 13:36:07.993520
[0m13:36:07.994244 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:36:07.998204 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:36:08.004625 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.005242 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:36:08.005882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:08.016650 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:36:08.017356 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.017945 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:36:08.020290 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:36:08.023142 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.023737 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:36:08.025329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:08.027997 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.028565 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:36:08.030297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:36:08.032554 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:36:08.033133 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.033692 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:36:08.036398 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:36:08.038965 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:36:08.039538 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:36:08.043210 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:36:08.044654 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:36:07.994736 => 2025-01-16 13:36:08.044605
[0m13:36:08.045201 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:36:08.046326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbc410ac0>]}
[0m13:36:08.047132 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m13:36:08.047993 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:36:08.049249 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:36:08.049910 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:36:08.050789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m13:36:08.051338 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m13:36:08.054794 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m13:36:08.060770 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 13:36:08.051809 => 2025-01-16 13:36:08.060711
[0m13:36:08.061328 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m13:36:08.066658 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m13:36:08.072760 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:36:08.073367 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m13:36:08.073906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:08.084970 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:36:08.085662 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:36:08.086375 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id, 
        title, 
        release_date, 
        price, 
        rating,
        user_rating
        CASE
            WHEN user_rating >= 4.5 THEN 'Execellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT 
        f.film_id, 
        f.title, 
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa USING film_id
    LEFT JOIN "destination_db"."public"."actors" a USING film_id
    GROUP BY f.film_id, f.title
);

SELECT
    films_with_ratings.*,
    films_with_actors.actors
FROM films_with_ratings
LEFT JOIN films_with_actors USING film_id;
  );
  
[0m13:36:08.088362 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WHEN"
LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
                     ^

[0m13:36:08.088904 [debug] [Thread-1 (]: On model.transforms.film_ratings: ROLLBACK
[0m13:36:08.090232 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 13:36:08.061801 => 2025-01-16 13:36:08.090174
[0m13:36:08.090757 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m13:36:08.095816 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "WHEN"
  LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
                       ^
  compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:36:08.096518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865b9744-c20a-4eba-ba24-6842d4af26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbc4462f0>]}
[0m13:36:08.097308 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.05s]
[0m13:36:08.098089 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:36:08.099920 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:08.100575 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:08.101085 [debug] [MainThread]: On master: BEGIN
[0m13:36:08.101597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:08.111626 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:36:08.112279 [debug] [MainThread]: On master: COMMIT
[0m13:36:08.112841 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:08.113421 [debug] [MainThread]: On master: COMMIT
[0m13:36:08.114739 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:36:08.115297 [debug] [MainThread]: On master: Close
[0m13:36:08.116164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:08.116659 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m13:36:08.117220 [info ] [MainThread]: 
[0m13:36:08.117948 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:36:08.118813 [debug] [MainThread]: Command end result
[0m13:36:08.130085 [info ] [MainThread]: 
[0m13:36:08.130965 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:36:08.131668 [info ] [MainThread]: 
[0m13:36:08.132348 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:36:08.133026 [error] [MainThread]:   syntax error at or near "WHEN"
[0m13:36:08.133726 [error] [MainThread]:   LINE 17:             WHEN user_rating >= 4.5 THEN 'Execellent'
[0m13:36:08.134429 [error] [MainThread]:                        ^
[0m13:36:08.135128 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:36:08.135995 [info ] [MainThread]: 
[0m13:36:08.136704 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:36:08.137460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc30d3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbfea9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbe5fa530>]}
[0m13:36:08.138237 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:41:39.762020 | 52ba79e3-a49d-44be-aab0-076b131aa47e ==============================
[0m13:41:39.762020 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:41:39.763872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:41:39.764522 [debug] [MainThread]: Tracking: tracking
[0m13:41:39.769751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62f50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62f57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62f5390>]}
[0m13:41:39.783541 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:41:39.921791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:39.922649 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_ratings.sql
[0m13:41:39.945881 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:41:40.013148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe4a60cd0>]}
[0m13:41:40.026756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62c60b0>]}
[0m13:41:40.027479 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:41:40.028242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe630c1f0>]}
[0m13:41:40.030184 [info ] [MainThread]: 
[0m13:41:40.032285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:40.033731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:41:40.043546 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:41:40.044126 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:41:40.044691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:40.064371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:41:40.066148 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:41:40.068421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:41:40.074393 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:41:40.075136 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:41:40.075786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:40.086347 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:41:40.087079 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:41:40.087666 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:41:40.091124 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:41:40.092858 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:41:40.094320 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:41:40.100728 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.101486 [debug] [MainThread]: On master: BEGIN
[0m13:41:40.102139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:40.112982 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:41:40.113666 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.114271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:40.119479 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:41:40.120980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe49ef580>]}
[0m13:41:40.121723 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:40.123381 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.123937 [debug] [MainThread]: On master: BEGIN
[0m13:41:40.126160 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:41:40.126761 [debug] [MainThread]: On master: COMMIT
[0m13:41:40.127318 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.127878 [debug] [MainThread]: On master: COMMIT
[0m13:41:40.129410 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:41:40.129972 [debug] [MainThread]: On master: Close
[0m13:41:40.131061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:40.131745 [info ] [MainThread]: 
[0m13:41:40.145789 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:41:40.146534 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:41:40.147541 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:41:40.148231 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:41:40.151406 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:41:40.157374 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:41:40.148785 => 2025-01-16 13:41:40.157315
[0m13:41:40.157940 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:41:40.193730 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:41:40.200342 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.200962 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:41:40.201515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:40.212134 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:41:40.212698 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.213238 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:41:40.215433 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:41:40.221074 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.221707 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:41:40.223290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.225875 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.226433 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:41:40.227961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.247518 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:41:40.248292 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.248909 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:41:40.251964 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:41:40.257210 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:41:40.257793 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:41:40.261736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:41:40.263211 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:41:40.158555 => 2025-01-16 13:41:40.263165
[0m13:41:40.263750 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:41:40.264727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe4169f30>]}
[0m13:41:40.266981 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.12s]
[0m13:41:40.269042 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:41:40.269799 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:41:40.270550 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:41:40.271651 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:41:40.272227 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:41:40.274700 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:41:40.280499 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:41:40.272695 => 2025-01-16 13:41:40.280442
[0m13:41:40.281096 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:41:40.286181 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:41:40.292463 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.293059 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:41:40.293572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:40.304174 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:41:40.304996 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.305564 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:41:40.307635 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:41:40.310474 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.311030 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:41:40.312547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.315146 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.315709 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:41:40.317396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.319995 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:41:40.320605 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.321198 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:41:40.324206 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:41:40.326374 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:41:40.326926 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:41:40.330349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:41:40.331921 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:41:40.281612 => 2025-01-16 13:41:40.331859
[0m13:41:40.332563 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:41:40.333561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd6f02a10>]}
[0m13:41:40.334385 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m13:41:40.335206 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:41:40.335965 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:41:40.336614 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:41:40.337577 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:41:40.338184 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:41:40.341123 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:41:40.347306 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:41:40.338685 => 2025-01-16 13:41:40.347252
[0m13:41:40.347985 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:41:40.352008 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:41:40.358197 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.358790 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:41:40.359329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:40.370516 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:41:40.371136 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.371820 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:41:40.374157 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:41:40.376960 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.377537 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:41:40.379077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.381631 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.382204 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:41:40.383837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:41:40.385849 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:41:40.386383 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.386897 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:41:40.389700 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:41:40.391932 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:41:40.392492 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:41:40.396338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:41:40.397881 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:41:40.348536 => 2025-01-16 13:41:40.397829
[0m13:41:40.398479 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:41:40.399539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd6f243d0>]}
[0m13:41:40.400428 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m13:41:40.401223 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:41:40.402524 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:41:40.403144 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:41:40.404159 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m13:41:40.404744 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m13:41:40.408033 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m13:41:40.414025 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 13:41:40.405220 => 2025-01-16 13:41:40.413964
[0m13:41:40.414593 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m13:41:40.419724 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m13:41:40.426038 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:41:40.426574 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m13:41:40.427144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:40.437850 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:41:40.438641 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:41:40.439259 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id, 
        title, 
        release_date, 
        price, 
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Execellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT 
        f.film_id, 
        f.title, 
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON a.actor_id = fa.actor_id
    GROUP BY f.film_id, f.title
);

SELECT
    films_with_ratings.*,
    films_with_actors.actors
FROM films_with_ratings
LEFT JOIN films_with_actors USING film_id;
  );
  
[0m13:41:40.441563 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 33: );
          ^

[0m13:41:40.442179 [debug] [Thread-1 (]: On model.transforms.film_ratings: ROLLBACK
[0m13:41:40.443574 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 13:41:40.415060 => 2025-01-16 13:41:40.443517
[0m13:41:40.444113 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m13:41:40.448942 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near ";"
  LINE 33: );
            ^
  compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:41:40.449676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ba79e3-a49d-44be-aab0-076b131aa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd6f562c0>]}
[0m13:41:40.450447 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.05s]
[0m13:41:40.451198 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:41:40.452951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:40.453567 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.454148 [debug] [MainThread]: On master: BEGIN
[0m13:41:40.454652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:40.465435 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:41:40.466233 [debug] [MainThread]: On master: COMMIT
[0m13:41:40.466745 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:40.467274 [debug] [MainThread]: On master: COMMIT
[0m13:41:40.468639 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:41:40.469160 [debug] [MainThread]: On master: Close
[0m13:41:40.469988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:40.471895 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m13:41:40.472485 [info ] [MainThread]: 
[0m13:41:40.473130 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:41:40.474001 [debug] [MainThread]: Command end result
[0m13:41:40.485593 [info ] [MainThread]: 
[0m13:41:40.486373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:41:40.487075 [info ] [MainThread]: 
[0m13:41:40.487791 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:41:40.488644 [error] [MainThread]:   syntax error at or near ";"
[0m13:41:40.489333 [error] [MainThread]:   LINE 33: );
[0m13:41:40.490102 [error] [MainThread]:             ^
[0m13:41:40.490809 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:41:40.491492 [info ] [MainThread]: 
[0m13:41:40.492180 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:41:40.492902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62c6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62c6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe62c4a00>]}
[0m13:41:40.493605 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:43:10.319114 | 61e24209-c61f-4ecf-b71a-7ddbf273ff2d ==============================
[0m13:43:10.319114 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:43:10.321106 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:10.321763 [debug] [MainThread]: Tracking: tracking
[0m13:43:10.327442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d72050f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d72057b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d7205390>]}
[0m13:43:10.340547 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:43:10.494475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:10.495340 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_ratings.sql
[0m13:43:10.517374 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:43:10.585691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d5960d30>]}
[0m13:43:10.599143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d71e60b0>]}
[0m13:43:10.599916 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:43:10.600719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d7208280>]}
[0m13:43:10.602797 [info ] [MainThread]: 
[0m13:43:10.605063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:10.606618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:43:10.616825 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:43:10.617413 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:43:10.617938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:10.638165 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:43:10.639857 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:43:10.641855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:43:10.647982 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:43:10.648662 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:43:10.649391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:10.660034 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:43:10.660675 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:43:10.661318 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:43:10.664527 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:43:10.666452 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:43:10.668044 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:43:10.674317 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.674909 [debug] [MainThread]: On master: BEGIN
[0m13:43:10.675493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:10.688355 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:10.689048 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.689592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:43:10.694116 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:43:10.695815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d58ef5e0>]}
[0m13:43:10.696621 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:10.698352 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.698982 [debug] [MainThread]: On master: BEGIN
[0m13:43:10.701422 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:10.701988 [debug] [MainThread]: On master: COMMIT
[0m13:43:10.702549 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.703144 [debug] [MainThread]: On master: COMMIT
[0m13:43:10.704575 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:10.705117 [debug] [MainThread]: On master: Close
[0m13:43:10.706061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:10.706798 [info ] [MainThread]: 
[0m13:43:10.721201 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:43:10.721987 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:43:10.723243 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:43:10.724002 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:43:10.727225 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:43:10.732837 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:43:10.724668 => 2025-01-16 13:43:10.732764
[0m13:43:10.733421 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:43:10.778600 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:43:10.785251 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.785846 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:43:10.786404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:10.797531 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:43:10.798237 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.798907 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:43:10.801332 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:43:10.807382 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.807994 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:43:10.809711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.813123 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.813860 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:43:10.816043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.841850 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:43:10.842874 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.843512 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:43:10.846971 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:43:10.852665 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:43:10.853345 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:43:10.860357 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:43:10.863523 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:43:10.733886 => 2025-01-16 13:43:10.863418
[0m13:43:10.864158 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:43:10.865193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a7fd1f60>]}
[0m13:43:10.866154 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.14s]
[0m13:43:10.868596 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:43:10.869553 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:43:10.870293 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:43:10.871440 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:43:10.871967 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:43:10.874667 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:43:10.880297 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:43:10.872461 => 2025-01-16 13:43:10.880242
[0m13:43:10.880916 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:43:10.887041 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:43:10.893128 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.893741 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:43:10.894309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:10.906064 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:43:10.906840 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.907492 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:43:10.909714 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:43:10.912901 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.913580 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:43:10.915508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.918357 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.918925 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:43:10.920648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.923141 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:43:10.923803 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.924424 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:43:10.927587 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:43:10.929891 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:43:10.930512 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:43:10.934159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:43:10.935516 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:43:10.881435 => 2025-01-16 13:43:10.935471
[0m13:43:10.936321 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:43:10.937456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a7ffa7d0>]}
[0m13:43:10.938313 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.07s]
[0m13:43:10.939359 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:43:10.940270 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:43:10.941111 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:43:10.942142 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:43:10.942949 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:43:10.945757 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:43:10.951629 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:43:10.943527 => 2025-01-16 13:43:10.951551
[0m13:43:10.952261 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:43:10.957066 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:43:10.963561 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:10.964176 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:43:10.964772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:10.975636 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:43:10.976472 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:10.977296 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:43:10.979738 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:43:10.982749 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:10.983366 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:43:10.985140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.988011 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:10.988748 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:43:10.990443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:43:10.993087 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:43:10.993744 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:10.994276 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:43:10.997171 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:43:10.999576 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:43:11.000154 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:43:11.004091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:43:11.005764 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:43:10.952821 => 2025-01-16 13:43:11.005711
[0m13:43:11.006368 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:43:11.007637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d5960940>]}
[0m13:43:11.008442 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.07s]
[0m13:43:11.009269 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:43:11.010565 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:43:11.011232 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:43:11.012266 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m13:43:11.013052 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m13:43:11.018276 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m13:43:11.024191 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 13:43:11.014028 => 2025-01-16 13:43:11.024125
[0m13:43:11.024754 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m13:43:11.031039 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m13:43:11.037502 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:43:11.038131 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m13:43:11.038734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:11.050033 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:43:11.050744 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:43:11.051295 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id, 
        title, 
        release_date, 
        price, 
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Execellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT 
        f.film_id, 
        f.title, 
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON a.actor_id = fa.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    films_with_ratings.*,
    films_with_actors.actors
FROM films_with_ratings
LEFT JOIN films_with_actors USING (film_id);
  );
  
[0m13:43:11.053527 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39: LEFT JOIN films_with_actors USING (film_id);
                                                    ^

[0m13:43:11.054069 [debug] [Thread-1 (]: On model.transforms.film_ratings: ROLLBACK
[0m13:43:11.055482 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 13:43:11.025204 => 2025-01-16 13:43:11.055424
[0m13:43:11.056146 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m13:43:11.061419 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near ";"
  LINE 39: LEFT JOIN films_with_actors USING (film_id);
                                                      ^
  compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:43:11.062148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e24209-c61f-4ecf-b71a-7ddbf273ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a5e3a320>]}
[0m13:43:11.062913 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.05s]
[0m13:43:11.063668 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:43:11.065679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:11.066252 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.066822 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.067366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:11.078295 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:11.079066 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.079676 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.080314 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.081635 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:11.082183 [debug] [MainThread]: On master: Close
[0m13:43:11.083249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:11.083865 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m13:43:11.084526 [info ] [MainThread]: 
[0m13:43:11.085361 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:43:11.086288 [debug] [MainThread]: Command end result
[0m13:43:11.099333 [info ] [MainThread]: 
[0m13:43:11.100332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:11.101068 [info ] [MainThread]: 
[0m13:43:11.101781 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:43:11.102405 [error] [MainThread]:   syntax error at or near ";"
[0m13:43:11.103109 [error] [MainThread]:   LINE 39: LEFT JOIN films_with_actors USING (film_id);
[0m13:43:11.103763 [error] [MainThread]:                                                       ^
[0m13:43:11.104369 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:43:11.105087 [info ] [MainThread]: 
[0m13:43:11.105742 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:43:11.106420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d5915ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d71e7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78d71e4af0>]}
[0m13:43:11.107005 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 13:44:56.863023 | 31db2d03-8a6c-401e-913a-ab55c2577b1c ==============================
[0m13:44:56.863023 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:44:56.865250 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:44:56.865860 [debug] [MainThread]: Tracking: tracking
[0m13:44:56.871078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa4090f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa4097b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa409390>]}
[0m13:44:56.883408 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:44:57.029762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:57.030626 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_ratings.sql
[0m13:44:57.052890 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:44:57.119089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8b6ccd0>]}
[0m13:44:57.131091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa3da0b0>]}
[0m13:44:57.131752 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:44:57.132466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa4201f0>]}
[0m13:44:57.134362 [info ] [MainThread]: 
[0m13:44:57.136486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:57.137937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:44:57.147664 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:44:57.148332 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:44:57.148972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:57.166907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:44:57.168467 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:44:57.170445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:44:57.176339 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:44:57.176939 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:44:57.177583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:57.188318 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:44:57.188977 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:44:57.189570 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:44:57.192640 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:44:57.194170 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:44:57.195618 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:44:57.201860 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.202511 [debug] [MainThread]: On master: BEGIN
[0m13:44:57.203111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:57.213516 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:44:57.214083 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.214695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:57.219748 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:44:57.221303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8aff580>]}
[0m13:44:57.222247 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:57.223960 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.224545 [debug] [MainThread]: On master: BEGIN
[0m13:44:57.227003 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:44:57.227614 [debug] [MainThread]: On master: COMMIT
[0m13:44:57.228217 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.228784 [debug] [MainThread]: On master: COMMIT
[0m13:44:57.230327 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:44:57.230870 [debug] [MainThread]: On master: Close
[0m13:44:57.231830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:57.232736 [info ] [MainThread]: 
[0m13:44:57.247069 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m13:44:57.247840 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:44:57.248864 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m13:44:57.249450 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m13:44:57.252260 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m13:44:57.258105 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 13:44:57.249992 => 2025-01-16 13:44:57.258027
[0m13:44:57.258731 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m13:44:57.294054 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m13:44:57.300371 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.300943 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m13:44:57.301447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:57.311916 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:44:57.312488 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.313076 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:44:57.315097 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:44:57.320839 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.321387 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:44:57.322935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.325462 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.325988 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:44:57.327453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.347809 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:44:57.348604 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.349422 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m13:44:57.352273 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:44:57.357496 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m13:44:57.358111 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:44:57.361827 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:44:57.363663 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 13:44:57.259210 => 2025-01-16 13:44:57.363608
[0m13:44:57.364253 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m13:44:57.365345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169b009f30>]}
[0m13:44:57.366162 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.12s]
[0m13:44:57.368507 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m13:44:57.369206 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m13:44:57.369884 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:44:57.370850 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m13:44:57.371472 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m13:44:57.374408 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m13:44:57.380618 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 13:44:57.372010 => 2025-01-16 13:44:57.380555
[0m13:44:57.381228 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m13:44:57.386724 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m13:44:57.393147 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.393670 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m13:44:57.394172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:57.404722 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:44:57.405443 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.406075 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:44:57.408372 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:44:57.411473 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.412075 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:44:57.413598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.416329 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.416926 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:44:57.418559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.420632 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:44:57.421156 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.421675 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m13:44:57.424441 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:44:57.426760 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m13:44:57.427358 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:44:57.431095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:44:57.432519 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 13:44:57.381758 => 2025-01-16 13:44:57.432474
[0m13:44:57.433092 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m13:44:57.434224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169b02aa10>]}
[0m13:44:57.435019 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m13:44:57.435800 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m13:44:57.436567 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m13:44:57.437214 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:44:57.438223 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m13:44:57.438866 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m13:44:57.441680 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m13:44:57.447704 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 13:44:57.439362 => 2025-01-16 13:44:57.447628
[0m13:44:57.448306 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m13:44:57.452509 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m13:44:57.458854 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.459421 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m13:44:57.460070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:57.470838 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:44:57.471617 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.472299 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:44:57.474566 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:44:57.477500 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.478078 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:44:57.479629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.482170 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.482682 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:44:57.484243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:44:57.486637 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:44:57.487208 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.487756 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m13:44:57.490552 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:44:57.493298 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m13:44:57.493905 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:44:57.497924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:44:57.499354 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 13:44:57.448822 => 2025-01-16 13:44:57.499309
[0m13:44:57.499939 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m13:44:57.501046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a8b6c9a0>]}
[0m13:44:57.501882 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m13:44:57.502734 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m13:44:57.504084 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m13:44:57.504758 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:44:57.505668 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m13:44:57.506207 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m13:44:57.509573 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m13:44:57.515284 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 13:44:57.506693 => 2025-01-16 13:44:57.515224
[0m13:44:57.515897 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m13:44:57.521205 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m13:44:57.527327 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:44:57.527901 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m13:44:57.528418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:57.539202 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:44:57.539899 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m13:44:57.540473 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT 
        film_id, 
        title, 
        release_date, 
        price, 
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Execellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT 
        f.film_id, 
        f.title, 
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON fa.film_id = f.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON a.actor_id = fa.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    films_with_ratings.*,
    films_with_actors.actors
FROM films_with_ratings
LEFT JOIN films_with_actors ON films_with_ratings.film_id = films_with_actors.film_id;
  );
  
[0m13:44:57.542942 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39: ...s ON films_with_ratings.film_id = films_with_actors.film_id;
                                                                       ^

[0m13:44:57.543491 [debug] [Thread-1 (]: On model.transforms.film_ratings: ROLLBACK
[0m13:44:57.544901 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 13:44:57.516390 => 2025-01-16 13:44:57.544809
[0m13:44:57.545433 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m13:44:57.550445 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near ";"
  LINE 39: ...s ON films_with_ratings.film_id = films_with_actors.film_id;
                                                                         ^
  compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:44:57.551137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31db2d03-8a6c-401e-913a-ab55c2577b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169b0762c0>]}
[0m13:44:57.551966 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.05s]
[0m13:44:57.552767 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m13:44:57.554686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:57.555283 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.555929 [debug] [MainThread]: On master: BEGIN
[0m13:44:57.556461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:57.566740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:44:57.567404 [debug] [MainThread]: On master: COMMIT
[0m13:44:57.567951 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:57.568516 [debug] [MainThread]: On master: COMMIT
[0m13:44:57.569894 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:44:57.570421 [debug] [MainThread]: On master: Close
[0m13:44:57.571304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:57.571878 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m13:44:57.572542 [info ] [MainThread]: 
[0m13:44:57.573212 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:44:57.574082 [debug] [MainThread]: Command end result
[0m13:44:57.586076 [info ] [MainThread]: 
[0m13:44:57.586882 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:57.587630 [info ] [MainThread]: 
[0m13:44:57.588326 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:44:57.589198 [error] [MainThread]:   syntax error at or near ";"
[0m13:44:57.589908 [error] [MainThread]:   LINE 39: ...s ON films_with_ratings.film_id = films_with_actors.film_id;
[0m13:44:57.590640 [error] [MainThread]:                                                                          ^
[0m13:44:57.591412 [error] [MainThread]:   compiled Code at target/run/transforms/models/example/film_ratings.sql
[0m13:44:57.592304 [info ] [MainThread]: 
[0m13:44:57.592966 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:44:57.593685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa3da650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa3da560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa3d89a0>]}
[0m13:44:57.594264 [debug] [MainThread]: Flushing usage events


============================== 2025-01-16 14:15:46.258176 | f70f3c67-7533-4139-a165-5eda3525ed9c ==============================
[0m14:15:46.258176 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:15:46.260191 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:15:46.260747 [debug] [MainThread]: Tracking: tracking
[0m14:15:46.262711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e111910c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e11191780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e11191360>]}
[0m14:15:46.276572 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:15:46.404620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:46.405485 [debug] [MainThread]: Partial parsing: updated file: transforms://models/example/film_ratings.sql
[0m14:15:46.427335 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:15:46.493269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0f8fcd60>]}
[0m14:15:46.507315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e11162110>]}
[0m14:15:46.507956 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:15:46.508666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e111ab910>]}
[0m14:15:46.510549 [info ] [MainThread]: 
[0m14:15:46.512864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:46.514421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:15:46.524637 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:15:46.525251 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:15:46.525885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:46.538465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:15:46.540119 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:15:46.542066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:15:46.547407 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:15:46.548013 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:15:46.548595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:46.559204 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:15:46.559943 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:15:46.560680 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:15:46.563970 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:15:46.565722 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:15:46.567246 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:15:46.573599 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.574204 [debug] [MainThread]: On master: BEGIN
[0m14:15:46.574734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:46.585474 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:15:46.586164 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.586758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:46.591503 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:15:46.593062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0f88b610>]}
[0m14:15:46.593790 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:46.595248 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.595831 [debug] [MainThread]: On master: BEGIN
[0m14:15:46.597981 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:15:46.598522 [debug] [MainThread]: On master: COMMIT
[0m14:15:46.599072 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.599593 [debug] [MainThread]: On master: COMMIT
[0m14:15:46.601021 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:15:46.601547 [debug] [MainThread]: On master: Close
[0m14:15:46.602371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:46.603217 [info ] [MainThread]: 
[0m14:15:46.615928 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m14:15:46.616726 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:15:46.617850 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m14:15:46.618563 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m14:15:46.621805 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m14:15:46.634948 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-16 14:15:46.619177 => 2025-01-16 14:15:46.634882
[0m14:15:46.635527 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m14:15:46.672556 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m14:15:46.678571 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.679195 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m14:15:46.679776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:46.690502 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:15:46.691083 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.691622 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:15:46.693789 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:15:46.699982 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.700567 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:15:46.702106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.704880 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.705432 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:15:46.706842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.727818 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m14:15:46.728591 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.729300 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m14:15:46.732543 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:15:46.737343 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m14:15:46.738028 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:15:46.741862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:15:46.743486 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-16 14:15:46.636005 => 2025-01-16 14:15:46.743432
[0m14:15:46.744094 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m14:15:46.745209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0dff9f30>]}
[0m14:15:46.746074 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.13s]
[0m14:15:46.748512 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m14:15:46.749245 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m14:15:46.750030 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:15:46.750977 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m14:15:46.751552 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m14:15:46.754234 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m14:15:46.760084 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-16 14:15:46.752048 => 2025-01-16 14:15:46.760036
[0m14:15:46.760624 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m14:15:46.765895 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m14:15:46.772379 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.772954 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m14:15:46.773497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:46.784351 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:15:46.785027 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.785588 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:15:46.787674 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:15:46.790793 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.791395 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:15:46.793207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.796349 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.796945 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:15:46.798580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.800874 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m14:15:46.801462 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.802024 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m14:15:46.804883 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:15:46.807217 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m14:15:46.807787 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:15:46.811192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:15:46.812752 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-16 14:15:46.761127 => 2025-01-16 14:15:46.812699
[0m14:15:46.813388 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m14:15:46.814358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0de25c30>]}
[0m14:15:46.815085 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m14:15:46.815807 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m14:15:46.816724 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m14:15:46.817446 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:15:46.818525 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m14:15:46.819143 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m14:15:46.822069 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m14:15:46.827861 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-16 14:15:46.819759 => 2025-01-16 14:15:46.827797
[0m14:15:46.828503 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m14:15:46.832847 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m14:15:46.838907 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.839443 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m14:15:46.839993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:46.850926 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:15:46.851574 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.852097 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:15:46.854388 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:15:46.857203 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.857819 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:15:46.859366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.862003 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.862544 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:15:46.864282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.866236 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m14:15:46.866768 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.867273 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m14:15:46.870031 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:15:46.872394 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m14:15:46.873222 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:15:46.876938 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:15:46.878336 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-16 14:15:46.829035 => 2025-01-16 14:15:46.878290
[0m14:15:46.878876 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m14:15:46.879895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0f8fc910>]}
[0m14:15:46.880677 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m14:15:46.881472 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m14:15:46.883233 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m14:15:46.883933 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:15:46.884993 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m14:15:46.885593 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m14:15:46.889053 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m14:15:46.894982 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-16 14:15:46.886075 => 2025-01-16 14:15:46.894921
[0m14:15:46.895584 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m14:15:46.901646 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m14:15:46.907616 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m14:15:46.908237 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m14:15:46.908839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:46.919792 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:15:46.920433 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m14:15:46.921026 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:15:46.927440 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:15:46.930661 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m14:15:46.931247 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:15:46.932889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:15:46.934852 [debug] [Thread-1 (]: On model.transforms.film_ratings: COMMIT
[0m14:15:46.935432 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m14:15:46.935993 [debug] [Thread-1 (]: On model.transforms.film_ratings: COMMIT
[0m14:15:46.938922 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:15:46.941529 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m14:15:46.942059 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:15:46.943518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:15:46.944911 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-16 14:15:46.896098 => 2025-01-16 14:15:46.944867
[0m14:15:46.945448 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m14:15:46.946481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70f3c67-7533-4139-a165-5eda3525ed9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e11163010>]}
[0m14:15:46.947243 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.06s]
[0m14:15:46.948076 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m14:15:46.950025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:46.950733 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.951452 [debug] [MainThread]: On master: BEGIN
[0m14:15:46.952010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:46.962151 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:15:46.962816 [debug] [MainThread]: On master: COMMIT
[0m14:15:46.963519 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:46.964147 [debug] [MainThread]: On master: COMMIT
[0m14:15:46.965871 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:15:46.966567 [debug] [MainThread]: On master: Close
[0m14:15:46.967662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:46.968175 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m14:15:46.968768 [info ] [MainThread]: 
[0m14:15:46.969598 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:15:46.970521 [debug] [MainThread]: Command end result
[0m14:15:46.982495 [info ] [MainThread]: 
[0m14:15:46.983213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:46.983914 [info ] [MainThread]: 
[0m14:15:46.984569 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:15:46.985320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e0de6b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e111626b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e111625c0>]}
[0m14:15:46.985971 [debug] [MainThread]: Flushing usage events


============================== 2025-01-17 15:44:19.267043 | 5137da54-69a0-47b5-9159-aaa7ca38b334 ==============================
[0m15:44:19.267043 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:44:19.269162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/opt/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:44:19.269872 [debug] [MainThread]: Tracking: tracking
[0m15:44:19.284134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afe9010c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afe901780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afe901360>]}
[0m15:44:19.297748 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:44:19.471698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:19.472369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:19.480468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afd030a00>]}
[0m15:44:19.495268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afd176020>]}
[0m15:44:19.496168 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:44:19.496949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afd176080>]}
[0m15:44:19.499304 [info ] [MainThread]: 
[0m15:44:19.501516 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:19.503059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:44:19.514055 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:44:19.514658 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:19.515233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:19.536716 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m15:44:19.538392 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:44:19.540513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:44:19.546926 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:44:19.547528 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:44:19.548086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:19.558897 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:44:19.559506 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:44:19.560078 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:44:19.563672 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m15:44:19.565439 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:44:19.567036 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:44:19.573072 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.573675 [debug] [MainThread]: On master: BEGIN
[0m15:44:19.574310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:19.584811 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:44:19.585498 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.586063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:19.591041 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:44:19.592633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afd07b8b0>]}
[0m15:44:19.593451 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:19.594964 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.595553 [debug] [MainThread]: On master: BEGIN
[0m15:44:19.597769 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:44:19.598307 [debug] [MainThread]: On master: COMMIT
[0m15:44:19.598961 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.599522 [debug] [MainThread]: On master: COMMIT
[0m15:44:19.600906 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:44:19.601439 [debug] [MainThread]: On master: Close
[0m15:44:19.602338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:19.603194 [info ] [MainThread]: 
[0m15:44:19.616569 [debug] [Thread-1 (]: Began running node model.transforms.actors
[0m15:44:19.617633 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m15:44:19.618845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.actors'
[0m15:44:19.619557 [debug] [Thread-1 (]: Began compiling node model.transforms.actors
[0m15:44:19.622583 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.actors"
[0m15:44:19.629058 [debug] [Thread-1 (]: Timing info for model.transforms.actors (compile): 2025-01-17 15:44:19.620109 => 2025-01-17 15:44:19.628989
[0m15:44:19.629782 [debug] [Thread-1 (]: Began executing node model.transforms.actors
[0m15:44:19.668382 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.actors"
[0m15:44:19.675243 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.675852 [debug] [Thread-1 (]: On model.transforms.actors: BEGIN
[0m15:44:19.676467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:19.687197 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:44:19.687841 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.688416 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:44:19.690629 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:44:19.696539 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.697185 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m15:44:19.698851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.701455 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.702007 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:44:19.703630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.724588 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m15:44:19.725317 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.726015 [debug] [Thread-1 (]: On model.transforms.actors: COMMIT
[0m15:44:19.729234 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:44:19.734110 [debug] [Thread-1 (]: Using postgres connection "model.transforms.actors"
[0m15:44:19.734650 [debug] [Thread-1 (]: On model.transforms.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m15:44:19.738733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:44:19.740354 [debug] [Thread-1 (]: Timing info for model.transforms.actors (execute): 2025-01-17 15:44:19.630324 => 2025-01-17 15:44:19.740305
[0m15:44:19.740914 [debug] [Thread-1 (]: On model.transforms.actors: Close
[0m15:44:19.741899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afd0672b0>]}
[0m15:44:19.742636 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.12s]
[0m15:44:19.744903 [debug] [Thread-1 (]: Finished running node model.transforms.actors
[0m15:44:19.745605 [debug] [Thread-1 (]: Began running node model.transforms.film_actors
[0m15:44:19.746339 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m15:44:19.747368 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_actors'
[0m15:44:19.747986 [debug] [Thread-1 (]: Began compiling node model.transforms.film_actors
[0m15:44:19.750980 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_actors"
[0m15:44:19.757114 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (compile): 2025-01-17 15:44:19.748492 => 2025-01-17 15:44:19.757062
[0m15:44:19.757680 [debug] [Thread-1 (]: Began executing node model.transforms.film_actors
[0m15:44:19.761606 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_actors"
[0m15:44:19.768127 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.768729 [debug] [Thread-1 (]: On model.transforms.film_actors: BEGIN
[0m15:44:19.769293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:19.780289 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:44:19.780933 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.781469 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:44:19.783644 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:44:19.786656 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.787221 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m15:44:19.788840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.791760 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.792392 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:44:19.793834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.797150 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m15:44:19.797729 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.798316 [debug] [Thread-1 (]: On model.transforms.film_actors: COMMIT
[0m15:44:19.801168 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:44:19.803885 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_actors"
[0m15:44:19.804500 [debug] [Thread-1 (]: On model.transforms.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m15:44:19.808041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:44:19.809546 [debug] [Thread-1 (]: Timing info for model.transforms.film_actors (execute): 2025-01-17 15:44:19.758159 => 2025-01-17 15:44:19.809498
[0m15:44:19.810109 [debug] [Thread-1 (]: On model.transforms.film_actors: Close
[0m15:44:19.811392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afcf39b40>]}
[0m15:44:19.812270 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.06s]
[0m15:44:19.813074 [debug] [Thread-1 (]: Finished running node model.transforms.film_actors
[0m15:44:19.814070 [debug] [Thread-1 (]: Began running node model.transforms.films
[0m15:44:19.814733 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m15:44:19.815720 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.films'
[0m15:44:19.816490 [debug] [Thread-1 (]: Began compiling node model.transforms.films
[0m15:44:19.819759 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.films"
[0m15:44:19.825823 [debug] [Thread-1 (]: Timing info for model.transforms.films (compile): 2025-01-17 15:44:19.817082 => 2025-01-17 15:44:19.825756
[0m15:44:19.826483 [debug] [Thread-1 (]: Began executing node model.transforms.films
[0m15:44:19.831299 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.films"
[0m15:44:19.837367 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.837900 [debug] [Thread-1 (]: On model.transforms.films: BEGIN
[0m15:44:19.838415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:19.848574 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:44:19.849236 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.849811 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:44:19.851920 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:44:19.854866 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.855438 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m15:44:19.857532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.860270 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.860824 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:44:19.862402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.864536 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m15:44:19.865108 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.865676 [debug] [Thread-1 (]: On model.transforms.films: COMMIT
[0m15:44:19.868405 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:44:19.870681 [debug] [Thread-1 (]: Using postgres connection "model.transforms.films"
[0m15:44:19.871346 [debug] [Thread-1 (]: On model.transforms.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m15:44:19.875141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:44:19.876668 [debug] [Thread-1 (]: Timing info for model.transforms.films (execute): 2025-01-17 15:44:19.827021 => 2025-01-17 15:44:19.876619
[0m15:44:19.877306 [debug] [Thread-1 (]: On model.transforms.films: Close
[0m15:44:19.878331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afcf3a980>]}
[0m15:44:19.879115 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.06s]
[0m15:44:19.879900 [debug] [Thread-1 (]: Finished running node model.transforms.films
[0m15:44:19.881466 [debug] [Thread-1 (]: Began running node model.transforms.film_ratings
[0m15:44:19.882063 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m15:44:19.883180 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.transforms.film_ratings'
[0m15:44:19.883870 [debug] [Thread-1 (]: Began compiling node model.transforms.film_ratings
[0m15:44:19.887506 [debug] [Thread-1 (]: Writing injected SQL for node "model.transforms.film_ratings"
[0m15:44:19.893732 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (compile): 2025-01-17 15:44:19.884464 => 2025-01-17 15:44:19.893669
[0m15:44:19.894345 [debug] [Thread-1 (]: Began executing node model.transforms.film_ratings
[0m15:44:19.899015 [debug] [Thread-1 (]: Writing runtime sql for node "model.transforms.film_ratings"
[0m15:44:19.905284 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m15:44:19.905851 [debug] [Thread-1 (]: On model.transforms.film_ratings: BEGIN
[0m15:44:19.906387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:19.917551 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:44:19.918366 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m15:44:19.918964 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m15:44:19.925832 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:44:19.928909 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m15:44:19.929490 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m15:44:19.931060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:44:19.932961 [debug] [Thread-1 (]: On model.transforms.film_ratings: COMMIT
[0m15:44:19.933547 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m15:44:19.934178 [debug] [Thread-1 (]: On model.transforms.film_ratings: COMMIT
[0m15:44:19.937221 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:44:19.940993 [debug] [Thread-1 (]: Using postgres connection "model.transforms.film_ratings"
[0m15:44:19.941594 [debug] [Thread-1 (]: On model.transforms.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "transforms", "target_name": "dev", "node_id": "model.transforms.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m15:44:19.943132 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:44:19.944545 [debug] [Thread-1 (]: Timing info for model.transforms.film_ratings (execute): 2025-01-17 15:44:19.894874 => 2025-01-17 15:44:19.944497
[0m15:44:19.945093 [debug] [Thread-1 (]: On model.transforms.film_ratings: Close
[0m15:44:19.946075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5137da54-69a0-47b5-9159-aaa7ca38b334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afcf8fac0>]}
[0m15:44:19.946846 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.06s]
[0m15:44:19.947676 [debug] [Thread-1 (]: Finished running node model.transforms.film_ratings
[0m15:44:19.949601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:19.950266 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.950843 [debug] [MainThread]: On master: BEGIN
[0m15:44:19.951459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:19.961512 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:44:19.962216 [debug] [MainThread]: On master: COMMIT
[0m15:44:19.963175 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:19.963942 [debug] [MainThread]: On master: COMMIT
[0m15:44:19.966510 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:44:19.967162 [debug] [MainThread]: On master: Close
[0m15:44:19.968108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:19.968707 [debug] [MainThread]: Connection 'model.transforms.film_ratings' was properly closed.
[0m15:44:19.969391 [info ] [MainThread]: 
[0m15:44:19.970149 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:44:19.971252 [debug] [MainThread]: Command end result
[0m15:44:19.983607 [info ] [MainThread]: 
[0m15:44:19.984429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:19.985166 [info ] [MainThread]: 
[0m15:44:19.985876 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:44:19.986660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afc57f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afcf8f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7afcf8f0a0>]}
[0m15:44:19.987288 [debug] [MainThread]: Flushing usage events
